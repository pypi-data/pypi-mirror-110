define("jupyter-bbox-widget",["@jupyter-widgets/base"],(e=>(()=>{"use strict";var t={306:e=>{e.exports=JSON.parse('{"name":"jupyter-bbox-widget","version":"0.2.0","description":"A Jupyter widget for annotating images with bounding boxes","keywords":["jupyter","jupyterlab","jupyterlab-extension","widgets"],"files":["lib/**/*.js","dist/*.js"],"homepage":"https://github.com/gereleth/jupyter-bbox-widget","bugs":{"url":"https://github.com/gereleth/jupyter-bbox-widget/issues"},"license":"BSD-3-Clause","author":{"name":"gereleth","email":"daria.voznyak@gmail.com"},"main":"lib/index.js","types":"./lib/index.d.ts","repository":{"type":"git","url":"https://github.com/gereleth/jupyter-bbox-widget"},"scripts":{"build":"npm run build:nbextension","build:labextension":"npm run clean:labextension && mkdirp jupyter_bbox_widget/labextension && cd jupyter_bbox_widget/labextension && npm pack ../..","build:nbextension":"webpack --mode=production","build:all":"npm run build:labextension && npm run build:nbextension","clean":"npm run clean:lib && npm run clean:nbextension","clean:lib":"rimraf lib","clean:labextension":"rimraf jupyter_bbox_widget/labextension","clean:nbextension":"rimraf jupyter_bbox_widget/nbextension/static/index.js","lint":"eslint . --ext .ts,.tsx --fix","lint:check":"eslint . --ext .ts,.tsx","prepack":"npm run build","watch":"npm-run-all -p watch:*","watch:nbextension":"webpack --watch","dev":"webpack-cli serve --inline --hot --progress --content-base ./mock --open -o ./mock"},"dependencies":{"@jupyter-widgets/base":"^4.0.0"},"devDependencies":{"@phosphor/application":"^1.6.0","@phosphor/widgets":"^1.6.0","@tsconfig/svelte":"^1.0.10","@types/node":"^10.11.6","@types/webpack-env":"^1.13.6","@typescript-eslint/eslint-plugin":"^3.6.0","@typescript-eslint/parser":"^3.6.0","@webpack-cli/serve":"^1.2.2","acorn":"^7.2.0","css-loader":"^5.2.6","eslint":"^7.4.0","eslint-config-prettier":"^6.11.0","eslint-plugin-prettier":"^3.1.4","fs-extra":"^7.0.0","mkdirp":"^0.5.1","npm-run-all":"^4.1.3","prettier":"^2.0.5","rimraf":"^2.6.2","source-map-loader":"^0.2.4","style-loader":"^1.0.0","svelte":"^3.0.0","svelte-loader":"2.13.3","svelte-preprocess":"^4.7.0","ts-loader":"^5.2.1","typescript":"^4.2.4","webpack":"^5.20.1","webpack-cli":"^4.4.0","webpack-dev-server":"^3.11.2"},"jupyterlab":{"extension":"lib/plugin"}}')},612:t=>{t.exports=e}},n={};function o(e){var s=n[e];if(void 0!==s)return s.exports;var i=n[e]={exports:{}};return t[e](i,i.exports,o),i.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{o.r(s),o.d(s,{BBoxModel:()=>Ie,BBoxView:()=>Ne,MODULE_NAME:()=>n,MODULE_VERSION:()=>t});const e=o(306),t=e.version,n=e.name;var i=o(612);function l(){}const r=e=>e;function c(e){return e()}function u(){return Object.create(null)}function a(e){e.forEach(c)}function d(e){return"function"==typeof e}function p(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function f(e){return 0===Object.keys(e).length}function h(e,t,n){e.$$.on_destroy.push(function(e,...t){if(null==e)return l;const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}(t,n))}function g(e){return null==e?"":e}function b(e,t,n=t){return e.set(n),t}const m="undefined"!=typeof window;let y=m?()=>window.performance.now():()=>Date.now(),v=m?e=>requestAnimationFrame(e):l;const x=new Set;function w(e){x.forEach((t=>{t.c(e)||(x.delete(t),t.f())})),0!==x.size&&v(w)}function $(e,t){e.appendChild(t)}function _(e,t,n){e.insertBefore(t,n||null)}function k(e){e.parentNode.removeChild(e)}function q(e){return document.createElement(e)}function E(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function M(e){return document.createTextNode(e)}function j(){return M(" ")}function C(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function S(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function O(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function z(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}let A;function D(){if(void 0===A){A=!1;try{"undefined"!=typeof window&&window.parent&&window.parent.document}catch(e){A=!0}}return A}function B(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}const P=new Set;let K,I=0;function N(e,t,n,o,s,i,l,r=0){const c=16.666/o;let u="{\n";for(let e=0;e<=1;e+=c){const o=t+(n-t)*i(e);u+=100*e+`%{${l(o,1-o)}}\n`}const a=u+`100% {${l(n,1-n)}}\n}`,d=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(a)}_${r}`,p=e.ownerDocument;P.add(p);const f=p.__svelte_stylesheet||(p.__svelte_stylesheet=p.head.appendChild(q("style")).sheet),h=p.__svelte_rules||(p.__svelte_rules={});h[d]||(h[d]=!0,f.insertRule(`@keyframes ${d} ${a}`,f.cssRules.length));const g=e.style.animation||"";return e.style.animation=`${g?`${g}, `:""}${d} ${o}ms linear ${s}ms 1 both`,I+=1,d}function W(e){K=e}function T(){if(!K)throw new Error("Function called outside component initialization");return K}const X=[],Y=[],R=[],L=[],F=Promise.resolve();let H=!1;function V(e){R.push(e)}function J(e){L.push(e)}let U=!1;const G=new Set;function Q(){if(!U){U=!0;do{for(let e=0;e<X.length;e+=1){const t=X[e];W(t),Z(t.$$)}for(W(null),X.length=0;Y.length;)Y.pop()();for(let e=0;e<R.length;e+=1){const t=R[e];G.has(t)||(G.add(t),t())}R.length=0}while(X.length);for(;L.length;)L.pop()();H=!1,U=!1,G.clear()}}function Z(e){if(null!==e.fragment){e.update(),a(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(V)}}let ee;function te(e,t,n){e.dispatchEvent(B(`${t?"intro":"outro"}${n}`))}const ne=new Set;let oe;function se(){oe={r:0,c:[],p:oe}}function ie(){oe.r||a(oe.c),oe=oe.p}function le(e,t){e&&e.i&&(ne.delete(e),e.i(t))}function re(e,t,n,o){if(e&&e.o){if(ne.has(e))return;ne.add(e),oe.c.push((()=>{ne.delete(e),o&&(n&&e.d(1),o())})),e.o(t)}}const ce={duration:0};function ue(e,t,n,o){let s=t(e,n),i=o?0:1,c=null,u=null,p=null;function f(){p&&function(e,t){const n=(e.style.animation||"").split(", "),o=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),s=n.length-o.length;s&&(e.style.animation=o.join(", "),I-=s,I||v((()=>{I||(P.forEach((e=>{const t=e.__svelte_stylesheet;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.__svelte_rules={}})),P.clear())})))}(e,p)}function h(e,t){const n=e.b-i;return t*=Math.abs(n),{a:i,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function g(t){const{delay:n=0,duration:o=300,easing:d=r,tick:g=l,css:b}=s||ce,m={start:y()+n,b:t};t||(m.group=oe,oe.r+=1),c||u?u=m:(b&&(f(),p=N(e,i,t,o,n,d,b)),t&&g(0,1),c=h(m,o),V((()=>te(e,t,"start"))),function(e){let t;0===x.size&&v(w),new Promise((n=>{x.add(t={c:e,f:n})}))}((t=>{if(u&&t>u.start&&(c=h(u,o),u=null,te(e,c.b,"start"),b&&(f(),p=N(e,i,c.b,c.duration,0,d,s.css))),c)if(t>=c.end)g(i=c.b,1-i),te(e,c.b,"end"),u||(c.b?f():--c.group.r||a(c.group.c)),c=null;else if(t>=c.start){const e=t-c.start;i=c.a+c.d*d(e/c.duration),g(i,1-i)}return!(!c&&!u)})))}return{run(e){d(s)?(ee||(ee=Promise.resolve(),ee.then((()=>{ee=null}))),ee).then((()=>{s=s(),g(e)})):g(e)},end(){f(),c=u=null}}}const ae="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function de(e,t){re(e,1,1,(()=>{t.delete(e.key)}))}let pe;function fe(e,t,n){const o=e.$$.props[t];void 0!==o&&(e.$$.bound[o]=n,n(e.$$.ctx[o]))}function he(e){e&&e.c()}function ge(e,t,n,o){const{fragment:s,on_mount:i,on_destroy:l,after_update:r}=e.$$;s&&s.m(t,n),o||V((()=>{const t=i.map(c).filter(d);l?l.push(...t):a(t),e.$$.on_mount=[]})),r.forEach(V)}function be(e,t){const n=e.$$;null!==n.fragment&&(a(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function me(e,t,n,o,s,i,r=[-1]){const c=K;W(e);const d=e.$$={fragment:null,ctx:null,props:i,update:l,not_equal:s,bound:u(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(c?c.$$.context:t.context||[]),callbacks:u(),dirty:r,skip_bound:!1};let p=!1;if(d.ctx=n?n(e,t.props||{},((t,n,...o)=>{const i=o.length?o[0]:n;return d.ctx&&s(d.ctx[t],d.ctx[t]=i)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](i),p&&function(e,t){-1===e.$$.dirty[0]&&(X.push(e),H||(H=!0,F.then(Q)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(e,t)),n})):[],d.update(),p=!0,a(d.before_update),d.fragment=!!o&&o(d.ctx),t.target){if(t.hydrate){const e=(f=t.target,Array.from(f.childNodes));d.fragment&&d.fragment.l(e),e.forEach(k)}else d.fragment&&d.fragment.c();t.intro&&le(e.$$.fragment),ge(e,t.target,t.anchor,t.customElement),Q()}var f;W(c)}new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(pe=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:e}=this.$$;this.$$.on_disconnect=e.map(c).filter(d);for(const e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(e,t,n){this[e]=n}disconnectedCallback(){a(this.$$.on_disconnect)}$destroy(){be(this,1),this.$destroy=l}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!f(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}});class ye{$destroy(){be(this,1),this.$destroy=l}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!f(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function ve(e){let t,n,o,s,i,r,c,u,d,p,f,h,g,b,m,y,v,x,w,q,A,D,B,P,K,I,N,W,T,X,Y,R,L,F,H,V,J,U,G,Q,Z,ee,te,ne,oe,se,ie,le,re,ce,ue,ae,de,pe,fe,he,ge,be,me,ye,ve,xe,we,$e,_e,ke;return{c(){t=E("text"),n=M(e[4]),i=j(),r=E("text"),c=M(e[4]),p=j(),f=E("rect"),y=j(),v=E("line"),D=j(),B=E("line"),W=j(),T=E("line"),F=j(),H=E("line"),Q=j(),Z=E("circle"),oe=j(),se=E("circle"),ce=j(),ue=E("circle"),fe=j(),he=E("circle"),ye=j(),ve=E("text"),xe=M("🗙"),S(t,"filter","url(#bg-text)"),S(t,"fill","black"),S(t,"x",o=e[2]*e[6]),S(t,"y",s=e[3]*e[7]-4),S(t,"class","svelte-1qdlnv1"),S(r,"x",u=e[2]*e[6]),S(r,"y",d=e[3]*e[7]-4),S(r,"fill","#333"),S(r,"class","svelte-1qdlnv1"),S(f,"width",h=e[0]*e[6]),S(f,"height",g=e[1]*e[7]),z(f,"fill-opacity",e[5]),z(f,"stroke-width",e[8]?3:2),z(f,"stroke",e[9]),S(f,"shape-rendering","crispEdges"),S(f,"x",b=e[2]*e[6]),S(f,"y",m=e[3]*e[7]),S(f,"class","svelte-1qdlnv1"),S(v,"x1",x=e[2]*e[6]),S(v,"y1",w=e[3]*e[7]),S(v,"x2",q=(e[2]+e[0])*e[6]),S(v,"y2",A=e[3]*e[7]),z(v,"stroke-width","10px"),z(v,"stroke","black"),z(v,"stroke-opacity","0"),S(v,"class","top svelte-1qdlnv1"),S(B,"x1",P=e[2]*e[6]),S(B,"y1",K=(e[3]+e[1])*e[7]),S(B,"x2",I=(e[2]+e[0])*e[6]),S(B,"y2",N=(e[3]+e[1])*e[7]),z(B,"stroke-width","10px"),z(B,"stroke","black"),z(B,"stroke-opacity","0"),S(B,"class","bottom svelte-1qdlnv1"),S(T,"x1",X=e[2]*e[6]),S(T,"y1",Y=e[3]*e[7]),S(T,"x2",R=e[2]*e[6]),S(T,"y2",L=(e[3]+e[1])*e[7]),z(T,"stroke-width","10px"),z(T,"stroke","black"),z(T,"stroke-opacity","0"),S(T,"class","left svelte-1qdlnv1"),S(H,"x1",V=(e[2]+e[0])*e[6]),S(H,"y1",J=e[3]*e[7]),S(H,"x2",U=(e[2]+e[0])*e[6]),S(H,"y2",G=(e[3]+e[1])*e[7]),z(H,"stroke-width","10px"),z(H,"stroke","black"),z(H,"stroke-opacity","0"),S(H,"class","right svelte-1qdlnv1"),S(Z,"cx",ee=e[2]*e[6]),S(Z,"cy",te=e[3]*e[7]),S(Z,"r",ne=6),S(Z,"fill-opacity","0"),S(Z,"class","top-left svelte-1qdlnv1"),S(se,"cx",ie=(e[2]+e[0])*e[6]),S(se,"cy",le=e[3]*e[7]),S(se,"r",re=6),S(se,"fill-opacity","0"),S(se,"class","top-right svelte-1qdlnv1"),S(ue,"cx",ae=e[2]*e[6]),S(ue,"cy",de=(e[3]+e[1])*e[7]),S(ue,"r",pe=6),S(ue,"fill-opacity","0"),S(ue,"class","bottom-left svelte-1qdlnv1"),S(he,"cx",ge=(e[2]+e[0])*e[6]),S(he,"cy",be=(e[3]+e[1])*e[7]),S(he,"r",me=6),S(he,"fill-opacity","0"),S(he,"class","bottom-right svelte-1qdlnv1"),S(ve,"x",we=(e[2]+e[0])*e[6]-13),S(ve,"y",$e=e[3]*e[7]-4),S(ve,"fill",e[9]),S(ve,"class","svelte-1qdlnv1")},m(o,s){_(o,t,s),$(t,n),_(o,i,s),_(o,r,s),$(r,c),_(o,p,s),_(o,f,s),_(o,y,s),_(o,v,s),_(o,D,s),_(o,B,s),_(o,W,s),_(o,T,s),_(o,F,s),_(o,H,s),_(o,Q,s),_(o,Z,s),_(o,oe,s),_(o,se,s),_(o,ce,s),_(o,ue,s),_(o,fe,s),_(o,he,s),_(o,ye,s),_(o,ve,s),$(ve,xe),_e||(ke=[C(r,"mousedown",e[13]),C(f,"mousedown",e[10]),C(v,"mousedown",e[17]),C(B,"mousedown",e[18]),C(T,"mousedown",e[19]),C(H,"mousedown",e[20]),C(Z,"mousedown",e[21]),C(se,"mousedown",e[22]),C(ue,"mousedown",e[23]),C(he,"mousedown",e[24]),C(ve,"mousedown",e[12])],_e=!0)},p(e,i){16&i[0]&&O(n,e[4]),68&i[0]&&o!==(o=e[2]*e[6])&&S(t,"x",o),136&i[0]&&s!==(s=e[3]*e[7]-4)&&S(t,"y",s),16&i[0]&&O(c,e[4]),68&i[0]&&u!==(u=e[2]*e[6])&&S(r,"x",u),136&i[0]&&d!==(d=e[3]*e[7]-4)&&S(r,"y",d),65&i[0]&&h!==(h=e[0]*e[6])&&S(f,"width",h),130&i[0]&&g!==(g=e[1]*e[7])&&S(f,"height",g),32&i[0]&&z(f,"fill-opacity",e[5]),256&i[0]&&z(f,"stroke-width",e[8]?3:2),512&i[0]&&z(f,"stroke",e[9]),68&i[0]&&b!==(b=e[2]*e[6])&&S(f,"x",b),136&i[0]&&m!==(m=e[3]*e[7])&&S(f,"y",m),68&i[0]&&x!==(x=e[2]*e[6])&&S(v,"x1",x),136&i[0]&&w!==(w=e[3]*e[7])&&S(v,"y1",w),69&i[0]&&q!==(q=(e[2]+e[0])*e[6])&&S(v,"x2",q),136&i[0]&&A!==(A=e[3]*e[7])&&S(v,"y2",A),68&i[0]&&P!==(P=e[2]*e[6])&&S(B,"x1",P),138&i[0]&&K!==(K=(e[3]+e[1])*e[7])&&S(B,"y1",K),69&i[0]&&I!==(I=(e[2]+e[0])*e[6])&&S(B,"x2",I),138&i[0]&&N!==(N=(e[3]+e[1])*e[7])&&S(B,"y2",N),68&i[0]&&X!==(X=e[2]*e[6])&&S(T,"x1",X),136&i[0]&&Y!==(Y=e[3]*e[7])&&S(T,"y1",Y),68&i[0]&&R!==(R=e[2]*e[6])&&S(T,"x2",R),138&i[0]&&L!==(L=(e[3]+e[1])*e[7])&&S(T,"y2",L),69&i[0]&&V!==(V=(e[2]+e[0])*e[6])&&S(H,"x1",V),136&i[0]&&J!==(J=e[3]*e[7])&&S(H,"y1",J),69&i[0]&&U!==(U=(e[2]+e[0])*e[6])&&S(H,"x2",U),138&i[0]&&G!==(G=(e[3]+e[1])*e[7])&&S(H,"y2",G),68&i[0]&&ee!==(ee=e[2]*e[6])&&S(Z,"cx",ee),136&i[0]&&te!==(te=e[3]*e[7])&&S(Z,"cy",te),69&i[0]&&ie!==(ie=(e[2]+e[0])*e[6])&&S(se,"cx",ie),136&i[0]&&le!==(le=e[3]*e[7])&&S(se,"cy",le),68&i[0]&&ae!==(ae=e[2]*e[6])&&S(ue,"cx",ae),138&i[0]&&de!==(de=(e[3]+e[1])*e[7])&&S(ue,"cy",de),69&i[0]&&ge!==(ge=(e[2]+e[0])*e[6])&&S(he,"cx",ge),138&i[0]&&be!==(be=(e[3]+e[1])*e[7])&&S(he,"cy",be),69&i[0]&&we!==(we=(e[2]+e[0])*e[6]-13)&&S(ve,"x",we),136&i[0]&&$e!==($e=e[3]*e[7]-4)&&S(ve,"y",$e),512&i[0]&&S(ve,"fill",e[9])},i:l,o:l,d(e){e&&k(t),e&&k(i),e&&k(r),e&&k(p),e&&k(f),e&&k(y),e&&k(v),e&&k(D),e&&k(B),e&&k(W),e&&k(T),e&&k(F),e&&k(H),e&&k(Q),e&&k(Z),e&&k(oe),e&&k(se),e&&k(ce),e&&k(ue),e&&k(fe),e&&k(he),e&&k(ye),e&&k(ve),_e=!1,a(ke)}}}function xe(e,t,n){let{width:o=0}=t,{height:s=0}=t,{x:i=0}=t,{y:l=0}=t,{label:r=""}=t,{colors:c=["red"]}=t,{classes:u=[]}=t,{opacity:a=0}=t,{toImageCoordinates:d}=t,{scaleX:p=1}=t,{scaleY:f=1}=t,{isActive:h=!1}=t;const g=function(){const e=T();return(t,n)=>{const o=e.$$.callbacks[t];if(o){const s=B(t,n);o.slice().forEach((t=>{t.call(e,s)}))}}}();let b=0,m=0,y=0,v=0,x=!1,w=!1,$="rgb(255,64,64)";function _(e){e.stopPropagation(),e.preventDefault();const t=(e.clientX-b)/p,o=(e.clientY-m)/f;n(2,i=Math.round(y+t)),n(3,l=Math.round(v+o))}function k(e,t){0===e.button&&(e.stopPropagation(),x=!1,w=!1,t.includes("top")?(w=!0,v=l+s):t.includes("bottom")&&(w=!0,v=l),t.includes("left")?(x=!0,y=i+o):t.includes("right")&&(x=!0,y=i),g("move",q))}function q(e){e.stopPropagation(),e.preventDefault();const t=d(e),r=Math.round(t.x),c=Math.round(t.y);x&&(n(2,i=Math.min(y,r)),n(0,o=Math.max(y,r)-i)),w&&(n(3,l=Math.min(v,c)),n(1,s=Math.max(v,c)-l))}var E;return E=()=>{y=i,v=l,b=i,m=l,x=!0,w=!0,g("create",q)},T().$$.on_mount.push(E),e.$$set=e=>{"width"in e&&n(0,o=e.width),"height"in e&&n(1,s=e.height),"x"in e&&n(2,i=e.x),"y"in e&&n(3,l=e.y),"label"in e&&n(4,r=e.label),"colors"in e&&n(14,c=e.colors),"classes"in e&&n(15,u=e.classes),"opacity"in e&&n(5,a=e.opacity),"toImageCoordinates"in e&&n(16,d=e.toImageCoordinates),"scaleX"in e&&n(6,p=e.scaleX),"scaleY"in e&&n(7,f=e.scaleY),"isActive"in e&&n(8,h=e.isActive)},e.$$.update=()=>{49168&e.$$.dirty[0]&&n(9,$=c[Math.max(0,u.indexOf(r)%c.length)])},[o,s,i,l,r,a,p,f,h,$,function(e){0===e.button&&(e.stopPropagation(),b=e.clientX,m=e.clientY,y=i,v=l,g("move",_))},k,function(e){0===e.button&&(e.stopPropagation(),g("remove"))},function(e){0===e.button&&(e.stopPropagation(),g("label"))},c,u,d,e=>k(e,"top"),e=>k(e,"bottom"),e=>k(e,"left"),e=>k(e,"right"),e=>k(e,"top-left"),e=>k(e,"top-right"),e=>k(e,"bottom-left"),e=>k(e,"bottom-right")]}const we=class extends ye{constructor(e){var t;super(),document.getElementById("svelte-1qdlnv1-style")||((t=q("style")).id="svelte-1qdlnv1-style",t.textContent="rect.svelte-1qdlnv1{cursor:move}.top.svelte-1qdlnv1,.bottom.svelte-1qdlnv1{cursor:row-resize}.left.svelte-1qdlnv1,.right.svelte-1qdlnv1{cursor:col-resize}text.svelte-1qdlnv1{cursor:pointer}.top-left.svelte-1qdlnv1{cursor:nw-resize}.top-right.svelte-1qdlnv1{cursor:ne-resize}.bottom-left.svelte-1qdlnv1{cursor:sw-resize}.bottom-right.svelte-1qdlnv1{cursor:se-resize}",$(document.head,t)),me(this,e,xe,ve,p,{width:0,height:1,x:2,y:3,label:4,colors:14,classes:15,opacity:5,toImageCoordinates:16,scaleX:6,scaleY:7,isActive:8},[-1,-1])}};function $e(e){let t,n;return{c(){t=q("i"),S(t,"class",n="fa fa-"+e[1])},m(e,n){_(e,t,n)},p(e,o){2&o&&n!==(n="fa fa-"+e[1])&&S(t,"class",n)},d(e){e&&k(t)}}}function _e(e){let t,n,o,s,i,r,c=""!==e[1]&&$e(e);return{c(){t=q("button"),c&&c.c(),n=j(),o=M(e[0]),S(t,"class",s=g(e[2])+" svelte-ft38eo"),S(t,"title",e[3])},m(s,l){_(s,t,l),c&&c.m(t,null),$(t,n),$(t,o),i||(r=C(t,"click",e[4]),i=!0)},p(e,[i]){""!==e[1]?c?c.p(e,i):(c=$e(e),c.c(),c.m(t,n)):c&&(c.d(1),c=null),1&i&&O(o,e[0]),4&i&&s!==(s=g(e[2])+" svelte-ft38eo")&&S(t,"class",s),8&i&&S(t,"title",e[3])},i:l,o:l,d(e){e&&k(t),c&&c.d(),i=!1,r()}}}function ke(e,t,n){let{text:o=""}=t,{icon:s=""}=t,{style:i=""}=t,{tooltip:l=""}=t;return e.$$set=e=>{"text"in e&&n(0,o=e.text),"icon"in e&&n(1,s=e.icon),"style"in e&&n(2,i=e.style),"tooltip"in e&&n(3,l=e.tooltip)},[o,s,i,l,function(t){!function(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e(t)))}(e,t)}]}const qe=class extends ye{constructor(e){var t;super(),document.getElementById("svelte-ft38eo-style")||((t=q("style")).id="svelte-ft38eo-style",t.textContent="button.svelte-ft38eo{display:inline-block;background-color:#eeeeee;width:148px;height:28px;line-height:28px;font-size:13px;padding:0 10px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:center;cursor:pointer;border:none;user-select:none}button.svelte-ft38eo:hover{box-shadow:0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 1px 5px 0 rgba(0, 0, 0, 0.12)}button.svelte-ft38eo:active{background-color:#bdbdbd}button.success.svelte-ft38eo{background-color:#4caf50;color:white}button.success.svelte-ft38eo:active{background-color:#388e3c}",$(document.head,t)),me(this,e,ke,_e,p,{text:0,icon:1,style:2,tooltip:3})}},Ee=[];function Me(e,t,n){const o=t,s=e.get(o),i=function(e,t=l){let n;const o=[];function s(t){if(p(e,t)&&(e=t,n)){const t=!Ee.length;for(let t=0;t<o.length;t+=1){const n=o[t];n[1](),Ee.push(n,e)}if(t){for(let e=0;e<Ee.length;e+=2)Ee[e][0](Ee[e+1]);Ee.length=0}}}return{set:s,update:function(t){s(t(e))},subscribe:function(i,r=l){const c=[i,r];return o.push(c),1===o.length&&(n=t(s)||l),i(e),()=>{const e=o.indexOf(c);-1!==e&&o.splice(e,1),0===o.length&&(n(),n=null)}}}}(void 0===s?n:s);return e.on("change:"+o,(()=>i.set(e.get(o))),null),{set:t=>{i.set(t),e.set(o,t),e.save_changes()},subscribe:i.subscribe,update:t=>{i.update((n=>{let s=t(n);return e.set(o,s),e.save_changes(),s}))}}}function je(e,{delay:t=0,duration:n=400,easing:o=r}={}){const s=+getComputedStyle(e).opacity;return{delay:t,duration:n,easing:o,css:e=>"opacity: "+e*s}}const{Map:Ce}=ae;function Se(e,t,n){const o=e.slice();return o[52]=t[n],o[54]=n,o}function Oe(e,t,n){const o=e.slice();return o[55]=t[n],o[56]=t,o[54]=n,o}function ze(e){let t,n,o,s,i,l,r,c,u=[],d=new Ce,p=e[0];const f=e=>e[10][e[54]];for(let t=0;t<p.length;t+=1){let n=Oe(e,p,t),o=f(n);d.set(o,u[t]=Ae(o,n))}return{c(){t=E("svg"),n=E("defs"),o=E("filter"),s=E("feFlood"),i=E("feComposite");for(let e=0;e<u.length;e+=1)u[e].c();S(s,"flood-color","rgba(255,255,255,0.5)"),S(i,"in","SourceGraphic"),S(i,"operator","xor"),S(o,"x","0"),S(o,"y","0"),S(o,"width","1"),S(o,"height","1"),S(o,"id","bg-text"),S(t,"width",e[6]),S(t,"height",e[5]),S(t,"class","svelte-o0quu8")},m(a,d){_(a,t,d),$(t,n),$(n,o),$(o,s),$(o,i);for(let e=0;e<u.length;e+=1)u[e].m(t,null);l=!0,r||(c=[C(t,"mousedown",e[23]),C(t,"mousemove",e[25]),C(t,"mouseup",e[24])],r=!0)},p(e,n){471883239&n[0]&&(p=e[0],se(),u=function(e,t,n,o,s,i,l,r,c,u,a,d){let p=e.length,f=i.length,h=p;const g={};for(;h--;)g[e[h].key]=h;const b=[],m=new Map,y=new Map;for(h=f;h--;){const e=d(s,i,h),o=n(e);let r=l.get(o);r?r.p(e,t):(r=u(o,e),r.c()),m.set(o,b[h]=r),o in g&&y.set(o,Math.abs(h-g[o]))}const v=new Set,x=new Set;function w(e){le(e,1),e.m(r,a),l.set(e.key,e),a=e.first,f--}for(;p&&f;){const t=b[f-1],n=e[p-1],o=t.key,s=n.key;t===n?(a=t.first,p--,f--):m.has(s)?!l.has(o)||v.has(o)?w(t):x.has(s)?p--:y.get(o)>y.get(s)?(x.add(o),w(t)):(v.add(s),p--):(c(n,l),p--)}for(;p--;){const t=e[p];m.has(t.key)||c(t,l)}for(;f;)w(b[f-1]);return b}(u,n,f,0,e,p,d,t,de,Ae,null,Oe),ie()),(!l||64&n[0])&&S(t,"width",e[6]),(!l||32&n[0])&&S(t,"height",e[5])},i(e){if(!l){for(let e=0;e<p.length;e+=1)le(u[e]);l=!0}},o(e){for(let e=0;e<u.length;e+=1)re(u[e]);l=!1},d(e){e&&k(t);for(let e=0;e<u.length;e+=1)u[e].d();r=!1,a(c)}}}function Ae(e,t){let n,o,s,i,l,r,c,u,a;function d(e){t[37](e,t[55])}function p(e){t[38](e,t[55])}function f(e){t[39](e,t[55])}function h(e){t[40](e,t[55])}function g(e){t[41](e,t[55])}let b={toImageCoordinates:t[21],classes:t[2],colors:t[14],scaleX:t[6]/t[8],scaleY:t[5]/t[7],isActive:t[10][t[54]]===t[1]};return void 0!==t[55].x&&(b.x=t[55].x),void 0!==t[55].y&&(b.y=t[55].y),void 0!==t[55].width&&(b.width=t[55].width),void 0!==t[55].height&&(b.height=t[55].height),void 0!==t[55].label&&(b.label=t[55].label),o=new we({props:b}),Y.push((()=>fe(o,"x",d))),Y.push((()=>fe(o,"y",p))),Y.push((()=>fe(o,"width",f))),Y.push((()=>fe(o,"height",h))),Y.push((()=>fe(o,"label",g))),o.$on("remove",(function(){return t[42](t[55])})),o.$on("move",(function(...e){return t[43](t[54],...e)})),o.$on("create",t[28]),o.$on("label",(function(){return t[44](t[55],t[56],t[54])})),{key:e,first:null,c(){n=E("g"),he(o.$$.fragment),this.first=n},m(e,t){_(e,n,t),ge(o,n,null),a=!0},p(e,n){t=e;const u={};4&n[0]&&(u.classes=t[2]),16384&n[0]&&(u.colors=t[14]),320&n[0]&&(u.scaleX=t[6]/t[8]),160&n[0]&&(u.scaleY=t[5]/t[7]),1027&n[0]&&(u.isActive=t[10][t[54]]===t[1]),!s&&1&n[0]&&(s=!0,u.x=t[55].x,J((()=>s=!1))),!i&&1&n[0]&&(i=!0,u.y=t[55].y,J((()=>i=!1))),!l&&1&n[0]&&(l=!0,u.width=t[55].width,J((()=>l=!1))),!r&&1&n[0]&&(r=!0,u.height=t[55].height,J((()=>r=!1))),!c&&1&n[0]&&(c=!0,u.label=t[55].label,J((()=>c=!1))),o.$set(u)},i(e){a||(le(o.$$.fragment,e),V((()=>{u||(u=ue(n,je,{duration:100},!0)),u.run(1)})),a=!0)},o(e){re(o.$$.fragment,e),u||(u=ue(n,je,{duration:100},!1)),u.run(0),a=!1},d(e){e&&k(n),be(o),e&&u&&u.end()}}}function De(e){let t,n,o,s,i,l,r=e[52]+"",c=e[54]<=9&&function(e){let t,n,o=(e[54]+1)%10+"";return{c(){t=q("span"),n=M(o),S(t,"class","key svelte-o0quu8")},m(e,o){_(e,t,o),$(t,n)},d(e){e&&k(t)}}}(e);function u(){return e[45](e[52])}return{c(){t=q("div"),n=M(r),o=j(),c&&c.c(),s=j(),S(t,"class","class-label svelte-o0quu8"),z(t,"color",e[14][e[54]%e[14].length]),z(t,"border",(e[52]===e[11]?1:0)+"px solid "+e[14][e[54]%e[14].length])},m(e,r){_(e,t,r),$(t,n),$(t,o),c&&c.m(t,null),$(t,s),i||(l=C(t,"click",u),i=!0)},p(o,s){e=o,4&s[0]&&r!==(r=e[52]+"")&&O(n,r),16384&s[0]&&z(t,"color",e[14][e[54]%e[14].length]),18436&s[0]&&z(t,"border",(e[52]===e[11]?1:0)+"px solid "+e[14][e[54]%e[14].length])},d(e){e&&k(t),c&&c.d(),i=!1,l()}}}function Be(e){let t,n,o,s,i,l,r,c,u,d,p,f,h,g,b,m,y,v,x;o=new qe({props:{text:"Skip",icon:"arrow-right",tooltip:"Keyboard shortcut: Space"}}),o.$on("click",e[31]),i=new qe({props:{text:"Submit",icon:"check",style:"success",tooltip:"Keyboard shortcut: Enter"}}),i.$on("click",e[32]);let w=e[9]&&ze(e),E=e[2],M=[];for(let t=0;t<E.length;t+=1)M[t]=De(Se(e,E,t));return{c(){t=q("div"),n=q("div"),he(o.$$.fragment),s=j(),he(i.$$.fragment),l=j(),r=q("div"),c=q("div"),u=q("img"),f=j(),w&&w.c(),h=j(),g=q("div"),b=q("p"),b.textContent="Classes:",m=j();for(let e=0;e<M.length;e+=1)M[e].c();S(n,"class","buttons svelte-o0quu8"),u.src!==(d=e[13])&&S(u,"src",d),S(u,"alt","annotate me"),S(u,"class","svelte-o0quu8"),S(c,"class","image-measure svelte-o0quu8"),V((()=>e[36].call(c))),S(r,"class","image svelte-o0quu8"),S(g,"class","classes svelte-o0quu8"),S(t,"class","wrapper svelte-o0quu8"),S(t,"tabindex","0")},m(a,d){_(a,t,d),$(t,n),ge(o,n,null),$(n,s),ge(i,n,null),$(t,l),$(t,r),$(r,c),$(c,u),e[35](u),p=function(e,t){"static"===getComputedStyle(e).position&&(e.style.position="relative");const n=q("iframe");n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.tabIndex=-1;const o=D();let s;return o?(n.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",s=C(window,"message",(e=>{e.source===n.contentWindow&&t()}))):(n.src="about:blank",n.onload=()=>{s=C(n.contentWindow,"resize",t)}),$(e,n),()=>{(o||s&&n.contentWindow)&&s(),k(n)}}(c,e[36].bind(c)),$(r,f),w&&w.m(r,null),$(t,h),$(t,g),$(g,b),$(g,m);for(let e=0;e<M.length;e+=1)M[e].m(g,null);e[46](t),y=!0,v||(x=[C(u,"load",e[22]),C(t,"keydown",e[47]),C(t,"keyup",e[48]),C(t,"blur",e[49])],v=!0)},p(e,t){if((!y||8192&t[0]&&u.src!==(d=e[13]))&&S(u,"src",d),e[9]?w?(w.p(e,t),512&t[0]&&le(w,1)):(w=ze(e),w.c(),le(w,1),w.m(r,null)):w&&(se(),re(w,1,1,(()=>{w=null})),ie()),18436&t[0]){let n;for(E=e[2],n=0;n<E.length;n+=1){const o=Se(e,E,n);M[n]?M[n].p(o,t):(M[n]=De(o),M[n].c(),M[n].m(g,null))}for(;n<M.length;n+=1)M[n].d(1);M.length=E.length}},i(e){y||(le(o.$$.fragment,e),le(i.$$.fragment,e),le(w),y=!0)},o(e){re(o.$$.fragment,e),re(i.$$.fragment,e),re(w),y=!1},d(n){n&&k(t),be(o),be(i),e[35](null),p(),w&&w.d(),function(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}(M,n),e[46](null),v=!1,a(x)}}}function Pe(e,t,n){let o,s,i,l,r,c,u,{model:a}=t,d=0,p=0,f=0,g=0,m=!1,y=[],v=[],x="",w=null,$=!1,_=new Set,k=Me(a,"image","");h(e,k,(e=>n(13,l=e)));let q=Me(a,"classes",[""]);h(e,q,(e=>n(2,i=e)));let E=Me(a,"colors",["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"]);h(e,E,(e=>n(14,r=e)));let M=Me(a,"bboxes",[]);h(e,M,(e=>n(34,o=e)));let j=Me(a,"selected_index",-1);function C(e){const t=u.getBoundingClientRect();return{x:(e.clientX-t.left)*g/p,y:(e.clientY-t.top)*f/d}}function S(){a.unset("bboxes",{silent:!0}),a.set("bboxes",o),a.save_changes()}function O(e){const t=o.indexOf(e);s>t&&b(j,s-=1,s),s==o.length-1&&b(j,s=-1,s),b(M,o=o.filter((t=>t!==e)),o)}h(e,j,(e=>n(1,s=e)));const z=new Map([["KeyW","up"],["KeyA","left"],["KeyS","down"],["KeyD","right"],["KeyQ","shrink-width"],["KeyE","grow-width"],["KeyR","grow-height"],["KeyF","shrink-height"]]);function A(e){if(e.stopPropagation(),e.preventDefault(),e.code.startsWith("Digit")||/Numpad\d/.test(e.code)){let t=Number(e.code.slice(-1));0===t&&(t=10),t-=1,t<i.length&&n(11,x=i[t])}else if("Escape"===e.code)c.blur();else if("Tab"===e.code){const t=e.shiftKey?-1:1;b(j,s+=t,s),s>=o.length?b(j,s=-1,s):-2===s&&b(j,s=o.length-1,s)}else"Space"===e.code?D():"Enter"!==e.code&&"NumpadEnter"!==e.code||B();if(s>=0){let t=z.get(e.code);t&&_.add(t),"Delete"===e.code&&O(o[s]),"KeyC"===e.code&&b(M,o[s].label=x,o);let n=e.shiftKey?10:1,i=0,l=0,r=0,c=0;for(let e of _)"up"===e?l-=n:"down"===e?l+=n:"right"===e?i+=n:"left"===e?i-=n:"shrink-width"===e?(r-=2*n,i+=n):"grow-width"===e?(r+=2*n,i-=n):"shrink-height"===e?(c-=2*n,l+=n):"grow-height"===e&&(c+=2*n,l-=n);0===i&&0===l&&0===r&&0===c||(b(M,o[s].x+=i,o),b(M,o[s].y+=l,o),b(M,o[s].width+=r,o),b(M,o[s].height+=c,o),S())}}function D(){a.send({type:"skip"},{}),c.focus()}function B(){a.send({type:"submit"},{}),c.focus()}return e.$$set=e=>{"model"in e&&n(33,a=e.model)},e.$$.update=()=>{4&e.$$.dirty[0]&&n(11,x=i.length>0?i[0]:""),2&e.$$.dirty[0]|8&e.$$.dirty[1]&&s>=o.length&&b(j,s=-1,s),2&e.$$.dirty[0]|8&e.$$.dirty[1]&&n(0,y=-1===s?o:[...o.filter(((e,t)=>t!==s)),o[s]]),1&e.$$.dirty[0]&&n(10,v=y.map(((e,t)=>{return n=t,-1===s?n:n===o.length-1?s:n<s?n:n+1;var n})))},[y,s,i,c,u,d,p,f,g,m,v,x,w,l,r,_,k,q,E,M,j,C,function(){n(9,m=!0),n(8,g=u.naturalWidth),n(7,f=u.naturalHeight);const e=u.getBoundingClientRect();n(5,d=e.height),n(6,p=e.width)},function(e){if(0!==e.button)return;const{x:t,y:n}=C(e),i={x:Math.round(t),y:Math.round(n),width:0,height:0,label:x};$=!0,b(M,o=[...o,i],o),b(j,s=o.length-1,s)},function(e){0===e.button&&(e.preventDefault(),n(12,w=null),S())},function(e){null!==w&&w(e)},S,O,function(e){$&&(n(12,w=e.detail),$=!1)},z,A,D,B,a,o,function(e){Y[e?"unshift":"push"]((()=>{u=e,n(4,u)}))},function(){d=this.clientHeight,p=this.clientWidth,n(5,d),n(6,p)},function(t,i){e.$$.not_equal(i.x,t)&&(i.x=t,n(0,y),n(1,s),n(34,o))},function(t,i){e.$$.not_equal(i.y,t)&&(i.y=t,n(0,y),n(1,s),n(34,o))},function(t,i){e.$$.not_equal(i.width,t)&&(i.width=t,n(0,y),n(1,s),n(34,o))},function(t,i){e.$$.not_equal(i.height,t)&&(i.height=t,n(0,y),n(1,s),n(34,o))},function(t,i){e.$$.not_equal(i.label,t)&&(i.label=t,n(0,y),n(1,s),n(34,o))},e=>O(e),(e,t)=>{n(12,w=t.detail),b(j,s=v[e],s)},(e,t,o)=>{n(0,t[o].label=x,y),S()},e=>n(11,x=e),function(e){Y[e?"unshift":"push"]((()=>{c=e,n(3,c)}))},e=>A(e),e=>_.delete(z.get(e.code)),()=>_.clear()]}const Ke=class extends ye{constructor(e){var t;super(),document.getElementById("svelte-o0quu8-style")||((t=q("style")).id="svelte-o0quu8-style",t.textContent=".wrapper.svelte-o0quu8{position:relative;margin:1px;padding:4px}.image.svelte-o0quu8{position:relative}.image-measure.svelte-o0quu8{display:table}img.svelte-o0quu8{display:block}svg.svelte-o0quu8{position:absolute;top:0;left:0}.class-label.svelte-o0quu8{cursor:pointer;border-radius:4px;padding:4px;margin:4px;display:inline-block\n  }.classes.svelte-o0quu8{margin-bottom:10px}.buttons.svelte-o0quu8{margin-bottom:10px}span.key.svelte-o0quu8{border:1px solid lightgray;color:gray;padding:0px 3px;font-size:80%;border-radius:2px}",$(document.head,t)),me(this,e,Pe,Be,p,{model:33},[-1,-1])}};class Ie extends i.DOMWidgetModel{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:Ie.model_name,_model_module:Ie.model_module,_model_module_version:Ie.model_module_version,_view_name:Ie.view_name,_view_module:Ie.view_module,_view_module_version:Ie.view_module_version})}}Ie.serializers=Object.assign({},i.DOMWidgetModel.serializers),Ie.model_name="BBoxModel",Ie.model_module=n,Ie.model_module_version=t,Ie.view_name="BBoxView",Ie.view_module=n,Ie.view_module_version=t;class Ne extends i.DOMWidgetView{render(){new Ke({target:this.el,props:{model:this.model}})}}})(),s})()));
//# sourceMappingURL=embed-bundle.js.map