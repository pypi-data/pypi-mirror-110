!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){const r="function"==typeof importScripts;var i=n(1);function o(t,e){console.error(e,"at "+t)}function s(t,e){console.warn(e,"at "+t)}let a=0;function u(t,e,n){const r=t._viewer,i=t.position;let o=0;switch(e){case"int8":case"char":o=r.getInt8(i),t.position++;break;case"uint8":case"uchar":o=r.getUint8(i),t.position++;break;case"int16":case"short":o=r.getInt16(i,n),t.position+=2;break;case"uint16":case"ushort":o=r.getUint16(i,n),t.position+=2;break;case"int32":case"int":o=r.getInt32(i,n),t.position+=4;break;case"uint32":case"uint":o=r.getUint32(i,n),t.position+=4;break;case"float32":case"float":o=r.getFloat32(i,n),t.position+=4;break;case"float64":case"double":o=r.getFloat64(i,n),t.position+=8}return o}function c(t){var e=new i(t),n=e.readUTF8(3);if("ply"!==n)throw new Error("point cloud magic should be pnts.  Magic "+n+" is not.");const r=function(t){let e,n=0,r=0;a=0;const i={elements:[],attributes:[],points_count:0};++a;try{for(;!t.empty();){let u=t.readLine();if(!u)continue;++a;const c=u.trim().split(/[\r\t ]/g),p=c[0];if("format"===p){const t=c[1],e=c[2];if(void 0===t||void 0===e)return o(a,"parse error: invalid element statement"),!1;if("ascii"===t)i.format=0;else if("binary_big_endian"===t)i.format=1;else{if("binary_little_endian"!==t)return o(a,"parse error: unknown format"),!1;i.format=2}if("1.0"!==e)return o(a,"version '"+e+"' is not supported"),!1;if(n>0)return o(a,"parse error: more than 1 format statement"),!1;++n}else if("element"===p){const t=c[1],n=c[2],s=parseInt(n);if(void 0===t||void 0===n||isNaN(s))return o(a,"parse error: invalid element statement"),!1;if(i.elements.find(e=>e.name===t))return o(a,"parse error: invalid elements"),!1;++r,e={name:t,count:s,properties:[]},i.elements.push(e)}else if("property"===p){if(0===r)return o(a,"parse error: property specified without any element declaration"),!1;const t=c[1];if(void 0===t)return o(a,"parse error: invalid property statement"),!1;if("list"!==t){const n=c[2],r=t;if(void 0===n)return o(a,"parse error: invalid variable property statement"),!1;if(e.properties.find(t=>t.name===n))return o(a,"parse error: duplicate property found"),!1;e.properties.push({type:r,name:n})}}else if("comment"===p)0;else if("obj_info"===p)0;else{if("end_header"===p)break;s(a,"ignoring line '"+u+"'")}}if(0===n)return o(a,"parse error: a format statement is required"),!1}catch(t){return console.error("[ply::PLYReader::readHeader] ",t),-1}return i}(e);return 2===r.format?function(t,e){const n=2===e.format,r=e.elements[0];if("vertex"===r.name){const i=r,o=i.count,s=new Float32Array(3*o);e.attributes.position=s,e.points_count=o;const a=new Float32Array(o);e.attributes.intensity=a;for(let e=0;e<o;e++)i.properties.forEach((r,i)=>{const o=u(t,r.type,n);"x"===r.name?s[3*e]=o:"y"===r.name?s[3*e+1]=o:"z"===r.name?s[3*e+2]=o:"intensity"===r.name&&(a[e]=o)})}}(e,r):function(t,e){const n=e.elements[0];if("vertex"===n.name){const r=n,i=r.count,s=new Float32Array(3*i);e.attributes.position=s,e.points_count=i;const u=new Float32Array(i);e.attributes.intensity=u;for(let e=0;e<i;e++){let n=t.readLine();if(n){++a;const t=n.trim().split(" ");if(t.length!==r.properties.length)return o(a,"parse error: element property count doesn't match the declaration in the header"),!1;r.properties.forEach((n,r)=>{let i=0;switch(n.type){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":i=parseInt(t[r]);break;case"float":case"double":case"float32":case"float64":i=parseFloat(t[r])}"x"===n.name?s[3*e]=i:"y"===n.name?s[3*e+1]=i:"z"===n.name?s[3*e+2]=i:"intensity"===n.name&&(u[e]=i)})}}}}(e,r),r}r||async function(){!function(){var t=arguments,e=(new Error).stack.split("\n")[2],n=e.substring(e.lastIndexOf(" "));Array.prototype.push.call(t,n),console.log.apply(null,t)}(c(await async function(t,e){e||(e="blob");var n=new XMLHttpRequest;return new Promise((r,i)=>{n.responseType=e,n.open("POST",t,!0),n.onload=function(){200==this.status||0==this.status?r(n.response):(console.error("failed to load: "+t+"["+this.status+"]"),i())},n.send()})}("/ply_examples/171.ply","arraybuffer")))}(),onmessage=function(t){let e=c(t.data.buffer);var n=e.points_count;let r=new Uint32Array(n);for(var i=0;i<n;i++)r[i]=i;let o,s,a,u=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],p=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],f=[0,0,0],l=e.attributes.position;for(let t=0;t<n;t++)o=l[3*t],s=l[3*t+1],a=l[3*t+2],isNaN(o)||isNaN(s)||isNaN(a)||(f[0]+=o/n,f[1]+=s/n,f[2]+=a/n,u[0]=Math.min(u[0],o),u[1]=Math.min(u[1],s),u[2]=Math.min(u[2],a),p[0]=Math.max(p[0],o),p[1]=Math.max(p[1],s),p[2]=Math.max(p[2],a));let h={mean:f,position:e.attributes.position.buffer,pointsCount:n,tightBoundingBox:{min:u,max:p},indices:r.buffer};postMessage(h,[h.position,h.indices])}},function(t,e){function n(t){this.position=0,this._viewer=new DataView(t),this._arraybuffer=t,this._size=t.byteLength}n.create=function(t){return new n(new ArrayBuffer(t))};var r=n.prototype;function i(t){var e=new Uint8Array(t);try{var n=String.fromCharCode.apply(null,e),r=decodeURIComponent(escape(n))}catch(t){}return r}r.readBuffer=function(t){if(t>0){var e=this._arraybuffer.slice(this.position,this.position+t);return this.position+=t,e}},r.writeUint32=function(t){t=this._viewer.setUint32(this.position,t,!0);return this.position+=4,t},r.readUint32=function(){var t=this._viewer.getUint32(this.position,!0);return this.position+=4,t},r.readFloat32=function(){var t=this._viewer.getFloat32(this.position,!0);return this.position+=4,t},r.readFloat64=function(){var t=this._viewer.getFloat64(this.position,!0);return this.position+=8,t},r.wrtieFloat=function(t){t=this._viewer.setFloat32(this.position,t,!0);return this.position+=4,t},r.readUTF8=function(t){if(t>0){var e=this._arraybuffer.slice(this.position,this.position+t);return this.position+=t,i(e)}return""},r.readLine=function(){for(var t=this.position;this.position<this._size&&10!==this._viewer.getUint8(this.position);)this.position++;return t<this._size?i(this._arraybuffer.slice(t,this.position++)):null},r.empty=function(){return!(this.position<this._size)},t.exports=n}]);