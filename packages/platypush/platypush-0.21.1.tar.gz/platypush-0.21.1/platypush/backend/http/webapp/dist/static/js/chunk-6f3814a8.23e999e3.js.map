{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.string.repeat.js","webpack:///./src/components/widgets/Music/Index.vue","webpack:///./src/components/widgets/Music/Index.vue?d7d3","webpack:///./src/components/widgets/Music/Index.vue?0587"],"names":["$","repeat","target","proto","class","loading","status","state","track","artist","title","style","time","elapsed","_withControls","prev","playPause","stop","next","volume","random","single","consume","name","components","Loading","mixins","Utils","props","refreshSeconds","type","Number","default","withControls","Boolean","data","undefined","timer","syncTime","timestamp","computed","this","parseBoolean","methods","refresh","request","_parseStatus","_parseTrack","stopTimer","startTimer","convertTime","parseFloat","t","h","parseInt","m","s","attr","ret","push","join","length","Object","entries","value","indexOf","showNewTrackNotification","notify","html","image","icon","onNewPlayingTrack","event","previousTrack","file","onMusicStop","onMusicPlay","onMusicPause","Date","onSeekChange","position","onVolumeChange","onRepeatChange","onRandomChange","onConsumeChange","onSingleChange","setInterval","timerFunc","clearInterval","getTime","_run","action","args","mounted","toFixed","subscribe","render","__scopeId"],"mappings":"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","file":"static/js/chunk-6f3814a8.23e999e3.js","sourcesContent":["var $ = require('../internals/export');\nvar repeat = require('../internals/string-repeat');\n\n// `String.prototype.repeat` method\n// https://tc39.es/ecma262/#sec-string.prototype.repeat\n$({ target: 'String', proto: true }, {\n  repeat: repeat\n});\n","<template>\n  <Loading v-if=\"loading\" />\n  <div class=\"music\" v-else>\n    <div class=\"track\">\n      <div class=\"unknown\" v-if=\"!status\">[Unknown state]</div>\n      <div class=\"no-track\" v-if=\"status && status.state === 'stop'\">No media is being played</div>\n      <div class=\"artist\" v-if=\"status && status.state !== 'stop' && track && track.artist\" v-text=\"track.artist\"></div>\n      <div class=\"title\" v-if=\"status && status.state !== 'stop' && track && track.title\" v-text=\"track.title\"></div>\n    </div>\n\n    <div class=\"time\"  v-if=\"status && status.state === 'play'\">\n      <div class=\"row\">\n        <div class=\"progress-bar\">\n          <div class=\"elapsed\" :style=\"{width: track.time ? 100*(status.elapsed/track.time) + '%' : '100%'}\"></div>\n          <div class=\"total\"></div>\n        </div>\n      </div>\n\n      <div class=\"row\">\n        <div class=\"col-6 time-elapsed\" v-text=\"convertTime(status.elapsed)\"></div>\n        <div class=\"col-6 time-total\" v-if=\"track.time\" v-text=\"convertTime(track.time)\"></div>\n      </div>\n    </div>\n\n    <div class=\"controls\" v-if=\"_withControls && status\">\n      <button @click=\"prev\">\n        <i class=\"fa fa-step-backward\" />\n      </button>\n      <button class=\"play-pause\" @click=\"playPause\">\n        <i class=\"fa fa-pause\" v-if=\"status.state === 'play'\" />\n        <i class=\"fa fa-play\" v-else />\n      </button>\n      <button @click=\"stop\" v-if=\"status.state !== 'stop'\">\n        <i class=\"fa fa-stop\" />\n      </button>\n      <button @click=\"next\">\n        <i class=\"fa fa-step-forward\" />\n      </button>\n    </div>\n\n    <div class=\"playback-status\" v-if=\"status\">\n      <div class=\"status-property col-4\">\n        <i class=\"fa fa-volume-up\"></i>&nbsp; <span v-text=\"status.volume + '%'\"></span>\n      </div>\n\n      <div class=\"status-property col-2\">\n        <i class=\"fas fa-random\" :class=\"{active: status.random}\"></i>\n      </div>\n      <div class=\"status-property col-2\">\n        <i class=\"fas fa-redo\" :class=\"{active: status.repeat}\"></i>\n      </div>\n      <div class=\"status-property col-2\">\n        <i class=\"fa fa-bullseye\" :class=\"{active: status.single}\"></i>\n      </div>\n      <div class=\"status-property col-2\">\n        <i class=\"fa fa-utensils\" :class=\"{active: status.consume}\"></i>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Utils from \"@/Utils\";\nimport Loading from \"@/components/Loading\";\n\nexport default {\n  name: \"Music\",\n  components: {Loading},\n  mixins: [Utils],\n  props: {\n    // Refresh interval in seconds.\n    refreshSeconds: {\n      type: Number,\n      default: 60,\n    },\n\n    // Set to true if you also want to include music controls in the widget.\n    withControls: {\n      type: Boolean,\n      default: true,\n    }\n  },\n\n  data() {\n    return {\n      track: undefined,\n      status: undefined,\n      timer: undefined,\n      loading: false,\n\n      syncTime: {\n        timestamp: null,\n        elapsed: null,\n      },\n    }\n  },\n\n  computed: {\n    _withControls() {\n      return this.parseBoolean(this.withControls)\n    },\n  },\n\n  methods: {\n    async refresh() {\n      this.loading = true\n\n      try {\n        let status = await this.request('music.mpd.status')\n        let track = await this.request('music.mpd.currentsong')\n\n        this._parseStatus(status)\n        this._parseTrack(track)\n\n        if (status.state === 'play' && !this.timer)\n          this.startTimer()\n        else if (status.state !== 'play' && this.timer)\n          this.stopTimer()\n      } finally {\n        this.loading = false\n      }\n    },\n\n    convertTime(time) {\n      time = parseFloat(time)   // Normalize strings\n      const t = {}\n      t.h = parseInt(time/3600)\n      t.m = parseInt(time/60 - t.h*60)\n      t.s = parseInt(time - (t.h*3600 + t.m*60))\n\n      for (const attr of ['m','s']) {\n        t[attr] = '' + t[attr]\n      }\n\n      for (const attr of ['m','s']) {\n        if (parseInt(t[attr]) < 10) {\n          t[attr] = '0' + t[attr]\n        }\n      }\n\n      const ret = []\n      if (parseInt(t.h)) {\n        ret.push(t.h)\n      }\n\n      ret.push(t.m, t.s)\n      return ret.join(':')\n    },\n\n    async _parseStatus(status) {\n      if (!status || status.length === 0)\n        status = await this.request('music.mpd.status')\n\n      if (!this.status)\n        this.status = {}\n\n      for (const [attr, value] of Object.entries(status)) {\n        if (['consume','random','repeat','single','bitrate'].indexOf(attr) >= 0) {\n          this.status[attr] = !!parseInt(value)\n        } else if (['nextsong','nextsongid','playlist','playlistlength',\n          'volume','xfade','song','songid'].indexOf(attr) >= 0) {\n          this.status[attr] = parseInt(value)\n        } else if (['elapsed'].indexOf(attr) >= 0) {\n          this.status[attr] = parseFloat(value)\n        } else {\n          this.status[attr] = value\n        }\n      }\n    },\n\n    async _parseTrack(track) {\n      if (!track || track.length === 0) {\n        track = await this.request('music.mpd.currentsong')\n      }\n\n      if (!this.track)\n        this.track = {}\n\n      for (const [attr, value] of Object.entries(track)) {\n        if (['id','pos','time','track','disc'].indexOf(attr) >= 0) {\n          this.track[attr] = parseInt(value)\n        } else {\n          this.track[attr] = value\n        }\n      }\n    },\n\n    showNewTrackNotification() {\n      this.notify({\n        html: '<b>' + (this.track.artist || '[No Artist]') + '</b><br>' +\n            (this.track.title || '[No Title]'),\n        image: {\n          icon: 'play',\n        }\n      })\n    },\n\n    async onNewPlayingTrack(event) {\n      let previousTrack = undefined\n\n      if (this.track) {\n        previousTrack = {\n          file: this.track.file,\n          artist: this.track.artist,\n          title: this.track.title,\n        }\n      }\n\n      this.status.state = 'play'\n      this.status.elapsed = 0\n      this.track = {}\n      this._parseTrack(event.track)\n\n      let status = event.status ? event.status : await this.request('music.mpd.status')\n      this._parseStatus(status)\n      this.startTimer()\n\n      if (!previousTrack || (this.track.file !== previousTrack.file\n          || this.track.artist !== previousTrack.artist\n          || this.track.title !== previousTrack.title)) {\n        this.showNewTrackNotification()\n      }\n    },\n\n    onMusicStop(event) {\n      this.status.state = 'stop'\n      this.status.elapsed = 0\n      this._parseStatus(event.status)\n      this._parseTrack(event.track)\n      this.stopTimer()\n    },\n\n    onMusicPlay(event) {\n      this.status.state = 'play'\n      this._parseStatus(event.status)\n      this._parseTrack(event.track)\n      this.startTimer()\n    },\n\n    onMusicPause(event) {\n      this.status.state = 'pause'\n      this._parseStatus(event.status)\n      this._parseTrack(event.track)\n\n      this.syncTime.timestamp = new Date()\n      this.syncTime.elapsed = this.status.elapsed\n    },\n\n    onSeekChange(event) {\n      if (event.position != null)\n        this.status.elapsed = parseFloat(event.position)\n      if (event.status)\n        this._parseStatus(event.status)\n      if (event.track)\n        this._parseTrack(event.track)\n\n      this.syncTime.timestamp = new Date()\n      this.syncTime.elapsed = this.status.elapsed\n    },\n\n    onVolumeChange(event) {\n      if (event.volume != null)\n        this.status.volume = parseFloat(event.volume)\n      if (event.status)\n        this._parseStatus(event.status)\n      if (event.track)\n        this._parseTrack(event.track)\n    },\n\n    onRepeatChange(event) {\n      this.status.repeat = event.state\n    },\n\n    onRandomChange(event) {\n      this.status.random = event.state\n    },\n\n    onConsumeChange(event) {\n      this.status.consume = event.state\n    },\n\n    onSingleChange(event) {\n      this.status.single = event.state\n    },\n\n    startTimer() {\n      if (this.timer != null) {\n        this.stopTimer()\n      }\n\n      this.syncTime.timestamp = new Date()\n      this.syncTime.elapsed = this.status.elapsed\n      this.timer = setInterval(this.timerFunc, 1000)\n    },\n\n    stopTimer() {\n      if (this.timer == null) {\n        clearInterval(this.timer)\n        this.timer = null\n      }\n    },\n\n    timerFunc() {\n      if (this.status.state !== 'play' || this.status.elapsed == null) {\n        return\n      }\n\n      this.status.elapsed = this.syncTime.elapsed +\n          ((new Date()).getTime()/1000) - (this.syncTime.timestamp.getTime()/1000)\n    },\n\n    async _run(action, args) {\n      args = args || {}\n      await this.request(`music.mpd.${action}`, args)\n      await this.refresh()\n    },\n\n    async playPause() {\n      return await this._run('pause')\n    },\n\n    async stop() {\n      return await this._run('stop')\n    },\n\n    async prev() {\n      return await this._run('previous')\n    },\n\n    async next() {\n      return await this._run('next')\n    },\n  },\n\n  mounted() {\n    this.refresh()\n    if (this.refreshSeconds) {\n      setInterval(this.refresh, parseInt((this.refreshSeconds*1000).toFixed(0)))\n    }\n\n    this.subscribe(this.onNewPlayingTrack, 'widget-music-on-new-track', 'platypush.message.event.music.NewPlayingTrackEvent')\n    this.subscribe(this.onMusicStop, 'widget-music-on-music-stop', 'platypush.message.event.music.MusicStopEvent')\n    this.subscribe(this.onMusicPlay, 'widget-music-on-music-play', 'platypush.message.event.music.MusicPlayEvent')\n    this.subscribe(this.onMusicPause, 'widget-music-on-music-pause', 'platypush.message.event.music.MusicPauseEvent')\n    this.subscribe(this.onSeekChange, 'widget-music-on-music-seek', 'platypush.message.event.music.SeekChangeEvent')\n    this.subscribe(this.onVolumeChange, 'widget-music-on-volume-change', 'platypush.message.event.music.VolumeChangeEvent')\n    this.subscribe(this.onRepeatChange, 'widget-music-on-repeat-change', 'platypush.message.event.music.PlaybackRepeatModeChangeEvent')\n    this.subscribe(this.onRandomChange, 'widget-music-on-random-change', 'platypush.message.event.music.PlaybackRandomModeChangeEvent')\n    this.subscribe(this.onConsumeChange, 'widget-music-on-consume-change', 'platypush.message.event.music.PlaybackConsumeModeChangeEvent')\n    this.subscribe(this.onSingleChange, 'widget-music-on-single-change', 'platypush.message.event.music.PlaybackSingleModeChangeEvent')\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n$progress-bar-bg: #ddd;\n$playback-status-color: #757f70;\n\n.music {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  position: relative;\n\n  .track {\n    text-align: center;\n\n    .unknown,\n    .no-track {\n      font-size: 2em;\n    }\n\n    .artist {\n      font-size: 1.9em;\n      font-weight: bold;\n      margin-bottom: .25em;\n    }\n\n    .title {\n      font-size: 1.8em;\n      font-weight: normal;\n    }\n  }\n\n  .time {\n    width: 100%;\n    margin-top: 1em;\n    font-size: 1.2em;\n\n    .row {\n      padding: 0 .5em;\n    }\n\n    .time-total {\n      text-align: right;\n    }\n\n    .progress-bar {\n      width: 100%;\n      height: 1em;\n      position: relative;\n      margin-bottom: .75em;\n\n      .total {\n        position: absolute;\n        width: 100%;\n        height: 100%;\n        top: 0;\n        background: $progress-bar-bg;\n        border-radius: 0.5em;\n      }\n\n      .elapsed {\n        position: absolute;\n        width: 100%;\n        height: 100%;\n        top: 0;\n        background: $selected-bg;\n        border-radius: 0.5em;\n        z-index: 1;\n      }\n    }\n  }\n\n  .playback-status {\n    position: absolute;\n    bottom: 0;\n    border-top: $default-border-2;\n    color: $playback-status-color;\n    width: 100%;\n    height: 2em;\n\n    .status-property {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      height: 100%;\n    }\n\n    .active {\n      color: $default-hover-fg;\n    }\n  }\n\n  .controls {\n    margin-top: .5em;\n    font-size: 1.2em;\n\n    button {\n      background: none;\n      border: none;\n\n      &:hover {\n        color: $default-hover-fg;\n      }\n\n      &.play-pause {\n        color: $selected-fg;\n        font-size: 1.5em;\n      }\n    }\n  }\n}\n</style>\n","import { render } from \"./Index.vue?vue&type=template&id=7e0e4f22&scoped=true\"\nimport script from \"./Index.vue?vue&type=script&lang=js\"\nexport * from \"./Index.vue?vue&type=script&lang=js\"\n\nimport \"./Index.vue?vue&type=style&index=0&id=7e0e4f22&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-7e0e4f22\"\n\nexport default script","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Index.vue?vue&type=style&index=0&id=7e0e4f22&lang=scss&scoped=true\""],"sourceRoot":""}