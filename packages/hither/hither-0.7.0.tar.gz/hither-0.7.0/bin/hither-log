#!/usr/bin/env python

import os
import time
from typing import Union
import click
import hither2 as hi

@click.group(help="View hither logs")
def cli():
    pass

@click.command(help='Print a log')
@click.option('--log-id', help='The ID of the log')
@click.option('--follow', is_flag=True, default=False, help='Whether to follow the log')
@click.option('--console', is_flag=True, default=False, help='Show console output of completed jobs')
@click.option('--job-id', default=None, help='Show job with ID')
def print(log_id: str, follow: bool, console: bool, job_id: Union[None, str]):
    L = hi.LogReader(log_id=log_id)
    while True:
        L.print(print_console=console, job_id=job_id)
        if not follow: return
        time.sleep(0.1)

cli.add_command(print)

if __name__ == "__main__":
    cli()