(self.webpackChunkipydraw=self.webpackChunkipydraw||[]).push([[480,568],{568:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),s=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),s(i(657),t),s(i(367),t),s(i(463),t)},480:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const a=i(565),r=o(i(568)),l=i(657),d={id:"ipydraw:plugin",requires:[a.IJupyterWidgetRegistry],activate:function(e,t){t.registerWidget({name:l.MODULE_NAME,version:l.MODULE_VERSION,exports:r})},autoStart:!0};t.default=d},463:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(s,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function r(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,r)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PointPickerView=t.PointPickerModel=void 0;const s=i(565),o=i(657);class a extends s.DOMWidgetModel{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:a.model_name,_model_module:a.model_module,_model_module_version:a.model_module_version,_view_name:a.view_name,_view_module:a.view_module,_view_module_version:a.view_module_version,points:[],n_points:null,image_src:""})}}t.PointPickerModel=a,a.serializers=Object.assign({},s.DOMWidgetModel.serializers),a.model_name="PointPickerModel",a.model_module=o.MODULE_NAME,a.model_module_version=o.MODULE_VERSION,a.view_name="PointPickerView",a.view_module=o.MODULE_NAME,a.view_module_version=o.MODULE_VERSION;class r extends s.DOMWidgetView{constructor(){super(...arguments),this.points=Array.from(this.model.get("points")),this.img=function(e){return n(this,void 0,void 0,(function*(){const t=new Image;return t.src=e,yield new Promise((e=>{t.onload=()=>e()})),t}))}(this.model.get("image_src")),this.onMouseDown=e=>{if(null!=this.nPoints&&this.points.length>=this.nPoints)return;const t=this.currentPoint(e);this.setPoints([...this.points,t])}}get nPoints(){return this.model.get("n_points")}render(){this.el.classList.add("ipydraw-canvas"),this.canvas=document.createElement("canvas"),this.canvas.style.border="1px solid #ccc",this.context=this.canvas.getContext("2d"),this.canvas.addEventListener("mousedown",this.onMouseDown),this.el.appendChild(this.canvas),this.el.appendChild(this.createClearButton()),this.redraw()}currentPoint(e){const t=this.canvas.getBoundingClientRect();return[e.clientX-t.left,e.clientY-t.top]}setPoints(e){this.points=e,this.model.set("points",this.points,{updated_view:this}),this.touch(),this.redraw()}redraw(){return n(this,void 0,void 0,(function*(){const e=yield this.img;this.canvas.width=e.width,this.canvas.height=e.height;const t=this.points||[],i=this.context;i.clearRect(0,0,this.canvas.width,this.canvas.height),i.drawImage(e,0,0,this.canvas.width,this.canvas.height),i.lineWidth=3,i.strokeStyle="#FF4444";const n=Math.max(.025*Math.max(this.canvas.width,this.canvas.height),5);for(const[e,s]of t)i.beginPath(),i.moveTo(e-n,s),i.lineTo(e+n,s),i.moveTo(e,s-n),i.lineTo(e,s+n),i.stroke()}))}createClearButton(){const e=document.createElement("button");return e.onclick=e=>{e.preventDefault(),this.setPoints([])},e.innerText="Clear!",e}}t.PointPickerView=r},657:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MODULE_NAME=t.MODULE_VERSION=void 0;const n=i(306);t.MODULE_VERSION=n.version,t.MODULE_NAME=n.name},367:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasView=t.CanvasModel=void 0;const n=i(565),s=i(657);class o extends n.DOMWidgetModel{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:o.model_name,_model_module:o.model_module,_model_module_version:o.model_module_version,_view_name:o.view_name,_view_module:o.view_module,_view_module_version:o.view_module_version,data:"",path:[],line_width:10,size:[200,200],color:!1})}}t.CanvasModel=o,o.serializers=Object.assign({},n.DOMWidgetModel.serializers),o.model_name="CanvasModel",o.model_module=s.MODULE_NAME,o.model_module_version=s.MODULE_VERSION,o.view_name="CanvasView",o.view_module=s.MODULE_NAME,o.view_module_version=s.MODULE_VERSION;class a extends n.DOMWidgetView{constructor(){super(...arguments),this.path=Array.from(this.model.get("path")),this.lastPoint=null,this.drawing=!1,this.onMouseMove=e=>{const t=this.currentPoint(e);this.lastPoint=t,this.drawing&&(this.path.push(t),this.redraw())},this.onMouseDown=e=>{this.lastPoint=this.currentPoint(e),this.drawing=!0,window.addEventListener("mouseup",this.onMouseUp)},this.onMouseUp=e=>{this.drawing=!1,this.path.push(null),this.redraw(),this.sendUpdate(),window.removeEventListener("mouseup",this.onMouseUp)}}render(){this.el.classList.add("ipydraw-canvas"),this.canvas=document.createElement("canvas"),this.canvas.width=this.model.get("size")[0],this.canvas.height=this.model.get("size")[1],this.canvas.style.border="1px solid #ccc",this.context=this.canvas.getContext("2d"),this.context.lineWidth=this.model.get("line_width"),this.context.strokeStyle="black",this.context.lineJoin="round",this.canvas.addEventListener("mousemove",this.onMouseMove),this.canvas.addEventListener("mousedown",this.onMouseDown),this.el.appendChild(this.canvas),this.el.appendChild(this.createClearButton()),this.model.get("color")&&this.el.appendChild(this.createColorPicker()),this.redraw()}currentPoint(e){const t=this.canvas.getBoundingClientRect();return[e.clientX-t.left,e.clientY-t.top]}redraw(){const e=this.path||[],t=this.context;let i=!1;t.strokeStyle="black";for(const n of[...e,null])null!==n?"string"!=typeof n?i?t.lineTo(...n):(t.moveTo(...n),t.beginPath(),i=!0):t.strokeStyle=n:i&&(t.stroke(),t.closePath(),i=!1)}sendUpdate(){this.model.set("data",this.canvas.toDataURL(),{updated_view:this}),this.model.set("path",Array.from(this.path),{updated_view:this}),this.touch()}createClearButton(){const e=document.createElement("button");return e.onclick=e=>{e.preventDefault(),this.path=[],this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.redraw(),this.sendUpdate()},e.innerText="Clear",e}createColorPicker(){const e=document.createElement("input");e.type="color";for(const t of this.path)"string"==typeof t&&(e.value=t);return e.onchange=e=>{this.path.push(e.currentTarget.value)},e}}t.CanvasView=a},306:e=>{"use strict";e.exports=JSON.parse('{"name":"ipydraw","version":"0.2.0","description":"Simple canvas for ipywidgets","keywords":["jupyter","jupyterlab","jupyterlab-extension","widgets"],"files":["lib/**/*.js","dist/*.js","css/*.css"],"unpkg":"dist/index.js","homepage":"https://github.com/travigd/ipydraw","bugs":{"url":"https://github.com/travigd/ipydraw/issues"},"license":"BSD-3-Clause","author":{"name":"Travis DePrato","email":"travis@pathbird.com"},"main":"lib/index.js","types":"./lib/index.d.ts","repository":{"type":"git","url":"https://github.com/travigd/ipydraw"},"scripts":{"build":"yarn run build:lib && yarn run build:nbextension && yarn run build:labextension:dev","build:prod":"yarn run build:lib && yarn run build:nbextension && yarn run build:labextension","build:labextension":"jupyter labextension build .","build:labextension:dev":"jupyter labextension build --development True .","build:lib":"tsc","build:nbextension":"webpack","clean":"yarn run clean:lib && yarn run clean:nbextension && yarn run clean:labextension","clean:lib":"rimraf lib","clean:labextension":"rimraf ipydraw/labextension","clean:nbextension":"rimraf ipydraw/nbextension/static/index.js","lint":"eslint . --ext .ts,.tsx --fix","lint:check":"eslint . --ext .ts,.tsx","prepack":"yarn run build:lib && webpack","test":"jest","watch":"npm-run-all -p watch:*","watch:lib":"tsc -w","watch:nbextension":"webpack --watch --mode=development","watch:labextension":"jupyter labextension watch ."},"dependencies":{"@jupyter-widgets/base":"^1.1.10 || ^2.0.0 || ^3.0.0 || ^4.0.0"},"devDependencies":{"@babel/core":"^7.5.0","@babel/preset-env":"^7.5.0","@jupyterlab/builder":"^3.0.0","@phosphor/application":"^1.6.0","@phosphor/widgets":"^1.6.0","@types/jest":"^26.0.0","@types/webpack-env":"^1.13.6","@typescript-eslint/eslint-plugin":"^3.6.0","@typescript-eslint/parser":"^3.6.0","acorn":"^7.2.0","css-loader":"^3.2.0","eslint":"^7.4.0","eslint-config-prettier":"^6.11.0","eslint-plugin-prettier":"^3.1.4","fs-extra":"^7.0.0","husky":"^6.0.0","identity-obj-proxy":"^3.0.0","jest":"^26.0.0","mkdirp":"^0.5.1","npm-run-all":"^4.1.3","prettier":"^2.0.5","rimraf":"^2.6.2","source-map-loader":"^1.1.3","style-loader":"^1.0.0","ts-jest":"^26.0.0","ts-loader":"^8.0.0","typescript":"~4.1.3","webpack":"^5.0.0","webpack-cli":"^4.0.0"},"jupyterlab":{"extension":"lib/plugin","outputDir":"ipydraw/labextension/","sharedPackages":{"@jupyter-widgets/base":{"bundled":false,"singleton":true}}}}')}}]);